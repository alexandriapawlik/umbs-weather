---
title: "R Notebook"
output: html_notebook
author: apawlik
---

Required packages
```{r}
library(tidyverse)
library(lubridate)
library(xlsx)
options(stringsAsFactors = FALSE)
```

Read CSV into data frames
```{r}
weather_78_89 <- read.csv("raw/Daily_Weather_Raw_1978-1989.csv")
weather_90_16 <- read.csv("raw/Daily_Weather_Raw_1990-2016.csv")
# TODO: check that data imported correctly
```

Read Excel files of recent data and combine sheets into one data frame
```{r}
# 32 as of May 2020, excludes notes sheet
num_sheets <- 32
# make a list of monthly sheets beginning with oldest 2 months
l1 <- read.xlsx("raw/Daily_Weather_Raw_2017-Present.xlsx", num_sheets)
l2 <- read.xlsx("raw/Daily_Weather_Raw_2017-Present.xlsx", num_sheets - 1)
weather_17_pres <- list(l1, l2)
for (i in (num_sheets - 2):1) {
  l <- read.xlsx("raw/Daily_Weather_Raw_2017-Present.xlsx", i)
  weather_17_pres <- append(weather_17_pres, list(l))
}
# TODO: check that data imported correctly
```

Clean monthly data 2017-present before combining into single data frame
```{r}
# ASK JASON: clean then combine or vice versa?
glimpse(weather_17_pres[[1]])

# remove columns and rows with only NA data
for (i in 1:num_sheets) {
  # convert to tbl_df to use dplyr functions
}

# check that each has correct number of rows and columns before combining
num_cols <- 17  # last column in excel sheet is Q

```

Clean 2 historic data sets before combining with monthly into final data frame